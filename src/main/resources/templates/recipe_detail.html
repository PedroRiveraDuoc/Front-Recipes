<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <title>Detalle de la receta</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.0/dist/tailwind.min.css" rel="stylesheet" />
</head>

<body class="bg-gradient-to-b from-green-200 to-green-400 bg-fixed h-full text-green-800">
  <!-- Navbar -->
  <div th:replace="~{fragments/navbar :: navbar(username=${username})}"></div>

  <!-- Contenedor principal -->
  <div class="max-w-4xl mx-auto p-8">
    <!-- Card de la receta -->
    <div class="bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden">
      <!-- Imagen de la receta -->
      <div class="w-full h-64">
        <div th:if="${recipe.photo != null}" class="h-full">
          <img th:src="${recipe.photo.url}" alt="Recipe Image" class="w-full h-full object-cover rounded-t-lg" />
        </div>
        <div th:if="${recipe.photo == null}" class="flex items-center justify-center h-full bg-gray-200">
          <p class="text-gray-500">🚫 No hay imágenes disponibles</p>
        </div>
      </div>

      <!-- Información de la receta -->
      <div class="p-8">
        <!-- Título de la receta -->
        <h1
          class="text-center mb-16 text-4xl font-extrabold leading-none tracking-tight text-gray-900 md:text-5xl lg:text-6xl dark:text-white"
          th:text="${recipe.title}">🍲 Título de la Receta
        </h1>
        <p class="text-lg text-center text-gray-700 mb-12" th:text="${recipe.description}">Descripción de la receta</p>

        <!-- Ingredientes -->
        <div class="mb-8">
          <h2 class="text-2xl font-semibold text-gray-900 mb-4 text-center">Ingredientes 🥕</h2>
          <div class="bg-gray-50 p-4 rounded-lg shadow-md">
            <ul class="list-disc pl-5 text-gray-700 space-y-2">
              <li th:each="ingredient : ${recipe.ingredients}" th:text="${ingredient}"></li>
            </ul>
          </div>
        </div>

        <!-- Instrucciones -->
        <div class="mb-8">
          <h2 class="text-2xl font-semibold text-gray-900 mb-4 text-center">Instrucciones 📜</h2>
          <div class="bg-gray-50 p-4 rounded-lg shadow-md">
            <ol class="list-decimal pl-5 text-gray-700 space-y-3">
              <li th:each="instruction : ${recipe.instructions.split(';')}" th:text="${instruction}"></li>
            </ol>
          </div>
        </div>

        <!-- Información adicional -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-center mb-8">
          <div class="bg-gray-50 p-4 rounded-lg shadow-md">
            <p class="text-lg font-semibold text-gray-900">⏱️ Tiempo de preparación</p>
            <p class="text-gray-700 text-xl font-bold"><span th:text="${recipe.cookTime}"></span> minutos</p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg shadow-md">
            <p class="text-lg font-semibold text-gray-900">🔥 Dificultad</p>
            <p class="text-gray-700 text-xl font-bold"><span th:text="${recipe.difficulty.getDisplayName()}"></span></p>
          </div>
        </div>
        <!-- Botones de Editar y Eliminar -->
        <div class="flex justify-end space-x-4 mt-6">
          <!-- Botón Editar -->
          <a th:href="@{/recipes/edit/{id}(id=${recipe.id})}"
            class="bg-yellow-500 text-white px-4 py-2 rounded-md hover:bg-yellow-600 transition-colors">
            Editar
          </a>

          <!-- Botón Eliminar (con confirmación) -->
          <form th:action="@{/recipes/delete/{id}(id=${recipe.id})}" method="post"
            onsubmit="return confirm('¿Estás seguro de que deseas eliminar esta receta?');">
            <button type="submit" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition-colors">
              Eliminar
            </button>
          </form>
        </div>

      </div>
    </div>
  </div>














  <!-- Formulario para agregar comentarios -->
  <div class="mt-8">
    <h2 class="text-2xl font-semibold text-gray-900 mb-4">Añadir un comentario</h2>
    <form th:action="@{/recipes/{id}/comments(id=${recipe.id})}" method="post" class="space-y-4">
      <textarea name="content" rows="4" placeholder="Escribe tu comentario aquí..."
        class="w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
      <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">
        Publicar comentario
      </button>
    </form>
  </div>

  <!-- Lista de comentarios -->
  <div class="mt-12">
    <h2 class="text-2xl font-semibold text-gray-900 mb-4">Comentarios</h2>
    <div th:if="${recipe.comments != null}">
      <div th:each="comment : ${recipe.comments}" class="bg-gray-50 p-4 rounded-lg shadow-md mb-4">
          <p class="text-gray-700"><strong th:text="${comment.username}">Usuario</strong>: 
              <span th:text="${comment.content}">Contenido del comentario</span></p>
          <p class="text-sm text-gray-500" th:text="${comment.createdAt}">Fecha</p>
      </div>
  </div>
  <div th:if="${recipe.comments == null}" class="text-gray-500">No hay comentarios todavía.</div>
  </div>














  <!-- Botón para volver -->
  <div class="text-center mt-10">
    <a href="/recipes" class="bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700">Volver a listado de
      recetas</a>
  </div>
  </div>

  <!-- Footer -->
  <div th:insert="~{fragments/footer :: footer}"></div>
</body>

</html>